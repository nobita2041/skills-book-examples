---
name: weekly-report
description: >
  製造業向けの週報を作成します。生産実績をQCD（品質・コスト・納期）の
  観点で整理し、グラフ付きのHTMLレポートとして出力します。
  「週報」「週次報告」「生産報告」「生産実績」などのキーワードで使用してください。
---

# 製造週報スキル

製造業向けの週次報告書を作成するスキルです。ヒアリングで情報を収集し、KPIカードとグラフ付きのHTMLレポートを出力します。

## ヒアリング手順

ユーザーから以下の情報を**段階的に**ヒアリングしてください。一度にすべてを聞かず、2〜3項目ずつ確認します。

### ステップ1: 基本情報と生産実績

まず以下を確認してください。

- 対象期間（例: 2026年2月10日〜2月14日）
- 宛先（例: 製造部 山田部長）
- 製品ごとの生産実績:
  - 品目名
  - 計画数
  - 実績数
  - 不良数（わかれば不良の内訳も）

### ステップ2: 設備・安全

次に以下を確認してください。

- 設備稼働率（%）
- メンテナンス実施内容（あれば）
- ヒヤリハット・安全関連の報告（あれば）

### ステップ3: 来週の予定と課題

最後に以下を確認してください。

- 来週の生産計画・主な予定
- 現在の課題・懸念事項

## 出力ワークフロー

すべてのヒアリングが完了したら、以下の手順でレポートを生成してください。

1. ヒアリング結果を整理し、以下のデータを算出する:
   - 製品ごとの計画達成率（実績数 ÷ 計画数 × 100）
   - 製品ごとの不良率（不良数 ÷ 実績数 × 100）
   - 全体の合計生産数、合計計画達成率、平均不良率
2. `templates/report-template.html` を読み込む
3. テンプレート内の `/* DATA_PLACEHOLDER */` から `/* DATA_PLACEHOLDER_END */` までのブロック全体（サンプルデータを含む）を、ヒアリング結果に基づいたJavaScriptオブジェクトで置換する
4. HTMLファイルとして保存する（ファイル名: `weekly-report-YYYY-MM-DD.html`）

## データ置換ルール

テンプレート内の `/* DATA_PLACEHOLDER */` を以下の形式のJavaScriptオブジェクトで置換してください:

```javascript
const reportData = {
  title: "製造週報",
  period: "2026年2月10日〜2月14日",
  author: "製造課 担当者名",
  recipient: "製造部 山田部長",
  createdDate: "2026-02-14",
  kpi: {
    totalProduction: 5200,
    defectRate: 1.2,
    operatingRate: 94.5,
    achievementRate: 98.1
  },
  products: [
    { name: "製品A", planned: 2000, actual: 1980, defects: 20 },
    { name: "製品B", planned: 1500, actual: 1520, defects: 15 },
    { name: "製品C", planned: 1800, actual: 1700, defects: 30 }
  ],
  sections: {
    results: "今週の生産実績・成果の本文をここに記載",
    safety: "設備・安全の本文をここに記載",
    nextWeek: "来週の予定をここに記載",
    issues: "課題・懸念事項をここに記載"
  }
};
```

## フォーマット仕様

レポートは以下の4セクション構成で作成してください。

1. **今週の生産実績・成果**: 製品別の生産数、計画達成率、特筆事項
2. **設備・安全**: 稼働率、メンテナンス、ヒヤリハット
3. **来週の予定**: 生産計画、予定されるイベント
4. **課題・懸念事項**: 対応が必要な問題点

### 文体ルール

- 敬語（ですます調）で簡潔に記述
- 数値で表現できる項目は極力数値化（生産数、不良率、稼働率など）
- 箇条書きを活用し、読みやすさを重視
- セクション本文はプレーンテキストとして出力する（HTMLタグは使用しない）
- 箇条書きには「・」を先頭に付与し、改行で区切る

## KPIカードの色分けルール

- **不良率**: 1%未満→緑、1〜2%→黄、2%超→赤
- **稼働率**: 95%以上→緑、90〜95%→黄、90%未満→赤
- **計画達成率**: 98%以上→緑、95〜98%→黄、95%未満→赤
